if (POLICY CMP0074)
  cmake_policy(SET CMP0074 NEW)
endif()

project(stereo_camera)


ADD_DEFINITIONS(-DASIO_STANDALONE)

include_directories(${CMAKE_CURRENT_SOURCE_DIR})
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/../../3rdparty/rpclib/include)
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/../../3rdparty/jsoncpp/include)
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/../../3rdparty/asio/include)
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/stereo_camera)

aux_source_directory(${CMAKE_CURRENT_SOURCE_DIR} REMOTE_STEREO_SRCS)
aux_source_directory(${CMAKE_CURRENT_SOURCE_DIR}/stereo_camera REMOTE_STEREO_SRCS)


SET(LIBS ${LIBS} jsoncpp)
SET(LIBS ${LIBS} rpc)


ADD_LIBRARY(stereo_camera SHARED ${REMOTE_STEREO_SRCS})
TARGET_LINK_LIBRARIES(stereo_camera ${LIBS})
ADD_LIBRARY(stereo_camera_static STATIC ${REMOTE_STEREO_SRCS})
set_target_properties(stereo_camera_static PROPERTIES OUTPUT_NAME "stereo_camera")
set_target_properties(stereo_camera PROPERTIES CLEAN_DIRECT_OUTPUT 1)
set_target_properties(stereo_camera_static PROPERTIES CLEAN_DIRECT_OUTPUT 1)
set_target_properties(stereo_camera PROPERTIES 
    ARCHIVE_OUTPUT_DIRECTORY "${PROJECT_BINARY_DIR}/lib"
    LIBRARY_OUTPUT_DIRECTORY "${PROJECT_BINARY_DIR}/lib"
    RUNTIME_OUTPUT_DIRECTORY "${PROJECT_BINARY_DIR}/bin")
set_target_properties(stereo_camera_static PROPERTIES 
    ARCHIVE_OUTPUT_DIRECTORY "${PROJECT_BINARY_DIR}/lib"
    LIBRARY_OUTPUT_DIRECTORY "${PROJECT_BINARY_DIR}/lib"
    RUNTIME_OUTPUT_DIRECTORY "${PROJECT_BINARY_DIR}/bin")

#IF(UNIX)
#    SET_PROPERTY(TARGET stereo_camera PROPERTY VERSION ${stereo_camera_VERSION})
#    SET_PROPERTY(TARGET stereo_camera PROPERTY SOVERSION ${stereo_camera_VERSION_MAJOR})
#ENDIF(UNIX)
INSTALL(TARGETS stereo_camera DESTINATION lib)
INSTALL(TARGETS stereo_camera_static DESTINATION lib)
#INSTALL(DIRECTORY . DESTINATION include FILES_MATCHING PATTERN "*.h")
#INSTALL(FILES ${CMAKE_CURRENT_SOURCE_DIR}/stereo_camera.h DESTINATION include)
#INSTALL(FILES ${CMAKE_CURRENT_SOURCE_DIR}/stream_func.h DESTINATION include)
#INSTALL(FILES ${CMAKE_CURRENT_SOURCE_DIR}/record_media.h DESTINATION include)
#INSTALL(FILES ${CMAKE_CURRENT_SOURCE_DIR}/discovery/broadcast_client.h DESTINATION include)